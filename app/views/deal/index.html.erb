<!DOCTYPE html>
<html>
  <head>
    <title>Place searches</title>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBInghLZWYDJBA789Ga2_2qTmM5DLb1nno&libraries=places"></script>
  </head>
  <body>
    
    <script>
    var data
    function myCallback(jsonpData){
    	data = jsonpData;
    	var len = (jsonpData.count >= 10)? 10: jsonpData.count;
    	for (var i = 0; i<len; i++){
    		console.log('lat: '+jsonpData.photos[i].latitude+', long: '+jsonpData.photos[i].longitude);
    		var image = document.createElement("img");
    		image.setAttribute('src', jsonpData.photos[i].photo_file_url);
    		document.body.appendChild(image);
    	}
    //}

		var map
		var myCenter = new google.maps.LatLng(data.photos[8].latitude, data.photos[8].longitude);
		
		//new google.maps.LatLng(47.606225,-122.334611);

		function initialize(){
			var mapProp = {
		    	center: myCenter,
			    zoom:2,
			    disableDefaultUI:true,
			    mapTypeId: google.maps.MapTypeId.ROADMAP
		  	};

			map = new google.maps.Map(document.getElementById("googleMap"),mapProp);

			var request = {
			    // placeID : something.place_id
			    location: myCenter,
			    radius: '1000',
			    types: ['hotel']
		  	};

		  	service = new google.maps.places.PlacesService(map);
		  
			service.nearbySearch(request, callback);

			function callback(results, status) {
			    if (status == google.maps.places.PlacesServiceStatus.OK) {
			      for (var i = 0; i < results.length; i++) {
			          createMarker(results[i]);
			      	}
			    }
			}// end callback

		  function createMarker(place) {
			  //var placeLoc = place.geometry.location;
			var marker = new google.maps.Marker({
				map: map,
				position: place.geometry.location
		  	});
		  	var infowindow = new google.maps.InfoWindow();

		  	google.maps.event.addListener(marker, 'click', function() {
		    	infowindow.setContent(place.name);
		    	infowindow.open(map, this);
		  	});

			}
		}
		// actually load the map
		google.maps.event.addDomListener(window, 'load', initialize);
	}
    </script>
    <script src = 'http://www.panoramio.com/map/get_panoramas.php?set=public&from=0&to=120&minx=-180&miny=-90&maxx=180&maxy=90&size=small&mapfilter=false&callback=myCallback'></script>
    <div id ="googleMap" style ="width:900px;height:500px;"></div>
  </body>
</html>